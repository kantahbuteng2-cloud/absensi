<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Scan Absensi</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
html,body{margin:0;padding:0;height:100%;background:#000;color:#fff;font-family:Arial}
#reader{width:100%;height:100vh}
#info{position:fixed;bottom:0;width:100%;background:#111;padding:12px;text-align:center}
</style>
</head>
<body>
<div id="reader"></div>
<div id="info">Arahkan kamera ke QR Code</div>
<script>
const API = 'URL_WEBAPP_GAS';
const device_id = localStorage.device_id;
const nip = localStorage.nip;
const nama = localStorage.nama;


function onScanSuccess(text){
fetch(API,{
method:'POST',
body:JSON.stringify({action:'absen',nip,nama,jenis:text.trim(),device_id})
}).then(r=>r.json()).then(d=>{
alert(d.message);
});
}


new Html5Qrcode('reader').start(
{ facingMode: 'environment' },
{ fps:10, qrbox:{width:250,height:250} },
onScanSuccess
);
</script>
</body>
</html>
